<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Genu√≠no Burguer - Delivery</title>
    <style>
        :root {
            --primary: #ea1d2c;
            --primary-hover: #fce8ea;
            --background: #f7f7f7;
            --text-dark: #3e3e3e;
            --text-light: #717171;
            --white: #ffffff;
            --border: #f2f2f2;
            --header-height: 150px;
        }

        * {
            margin: 0; padding: 0; box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html { scroll-behavior: smooth; scroll-padding-top: var(--header-height); }
        body { background-color: var(--background); color: var(--text-dark); padding-bottom: 90px; }

        /* Header Atualizado (Maior) */
        .sticky-top {
            position: sticky; top: 0; z-index: 100;
            background: var(--white); box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        header { padding: 15px 20px; display: flex; align-items: center; justify-content: space-between; }
        .brand-info { display: flex; align-items: center; gap: 15px; }
        .logo { width: 75px; height: 75px; border-radius: 50%; object-fit: cover; border: 1px solid var(--border); }
        .store-details h1 { font-size: 18px; font-weight: 700; }
        .store-details p { font-size: 13px; color: var(--text-light); }
        .delivery-time { font-size: 12px; font-weight: 700; color: var(--primary); margin-top: 4px; display: inline-block; background: var(--primary-hover); padding: 4px 8px; border-radius: 6px;}

        .header-actions { display: flex; align-items: center; gap: 15px; }
        .login-btn-header { background: none; border: none; color: var(--primary); font-weight: 600; font-size: 14px; cursor: pointer; }

        .ifood-partner { display: flex; flex-direction: column; align-items: center; font-size: 11px; color: var(--primary); font-weight: 700; }
        .ifood-partner img { width: 55px; margin-top: 4px; }

        /* Nav & Listas */
        .categories-nav { padding: 12px 20px; display: flex; overflow-x: auto; gap: 10px; white-space: nowrap; scrollbar-width: none; border-top: 1px solid var(--border); }
        .categories-nav::-webkit-scrollbar { display: none; }
        .category-chip { padding: 8px 16px; background: var(--background); border-radius: 20px; font-size: 14px; font-weight: 600; color: var(--text-dark); text-decoration: none; transition: 0.3s; }
        .category-chip:hover { background: var(--primary-hover); color: var(--primary); }
        .category-chip.active { background: var(--primary); color: var(--white); }

        .highlights-section { background: var(--white); padding: 20px 0; margin-bottom: 10px; }
        .section-title { font-size: 18px; margin-bottom: 15px; color: var(--text-dark); padding: 0 20px; }
        .horizontal-scroll { display: flex; overflow-x: auto; gap: 15px; padding: 0 20px; scrollbar-width: none; scroll-snap-type: x mandatory; }
        .horizontal-scroll::-webkit-scrollbar { display: none; }
        .highlight-card { min-width: 260px; max-width: 260px; background: var(--white); border: 1px solid var(--border); border-radius: 8px; padding: 15px; scroll-snap-align: start; cursor: pointer; display: flex; gap: 10px; }
        .highlight-info { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .highlight-img { width: 80px; height: 80px; border-radius: 8px; object-fit: cover; }

        .menu-section { background: var(--white); margin-bottom: 10px; padding: 20px; }
        .product-card { display: flex; justify-content: space-between; align-items: flex-start; padding: 15px 0; border-bottom: 1px solid var(--border); cursor: pointer; }
        .product-card:last-child { border-bottom: none; padding-bottom: 0; }
        .product-card:first-of-type { padding-top: 0; }
        .product-info { flex: 1; padding-right: 15px; }
        .product-name { font-size: 15px; font-weight: 600; margin-bottom: 5px; line-height: 1.2; }
        .product-desc { font-size: 13px; color: var(--text-light); margin-bottom: 8px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.4; }
        .product-price { font-size: 15px; font-weight: 700; color: var(--text-dark); }
        .product-img { width: 100px; height: 100px; border-radius: 8px; object-fit: cover; }

        /* Modais */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; display: none; justify-content: center; align-items: flex-end; }
        .modal-content { background: var(--background); width: 100%; max-width: 600px; height: 90vh; border-radius: 20px 20px 0 0; display: flex; flex-direction: column; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .modal-header { background: var(--white); padding: 15px 20px; border-radius: 20px 20px 0 0; position: relative; text-align: center; border-bottom: 1px solid var(--border); }
        .close-modal { position: absolute; left: 20px; top: 15px; font-size: 28px; line-height: 20px; color: var(--text-light); cursor: pointer; border: none; background: none; }
        .modal-body { overflow-y: auto; flex: 1; padding-bottom: 20px; }
        .modal-footer { padding: 15px 20px; background: var(--white); box-shadow: 0 -2px 10px rgba(0,0,0,0.05); }

        /* Modal Centralizado (Para Alertas Customizados) */
        .modal-center { align-items: center; z-index: 2000; }
        .modal-center .modal-content { height: auto; max-height: 90vh; width: 90%; max-width: 350px; border-radius: 16px; padding: 25px; text-align: center; animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* Bot√µes & Inputs */
        .btn-primary { background: var(--primary); color: var(--white); border: none; padding: 16px; border-radius: 8px; font-weight: 600; font-size: 16px; width: 100%; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 10px;}
        .btn-secondary { background: var(--white); color: var(--primary); border: 1px solid var(--primary); padding: 16px; border-radius: 8px; font-weight: 600; font-size: 16px; width: 100%; cursor: pointer; margin-top: 10px;}
        .input-group { margin-bottom: 15px; text-align: left;}
        .input-group label { display: block; font-size: 13px; color: var(--text-light); margin-bottom: 5px; font-weight: 600;}
        .form-control { width: 100%; padding: 15px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; outline: none; background: var(--white);}
        .form-control:focus { border-color: var(--primary); }
        .form-control[readonly] { background: #eee; color: #777; cursor: not-allowed; }

        /* Detalhes do Produto */
        .modal-product-header { background: var(--white); padding: 20px; margin-bottom: 10px; }
        .modal-product-img { width: 100%; height: 220px; object-fit: cover; border-radius: 8px; margin-bottom: 15px; }
        .option-group { background: var(--white); padding: 20px; margin-bottom: 10px; }
        .option-group-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .option-group-title { font-size: 16px; font-weight: 700; }
        .option-group-subtitle { font-size: 13px; color: var(--text-light); margin-bottom: 15px; display: block; }
        .option-badge { background: var(--text-dark); color: var(--white); font-size: 11px; padding: 4px 8px; border-radius: 4px; font-weight: 600; }
        .option-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-top: 1px solid var(--border); }
        .option-item label { display: flex; align-items: center; gap: 15px; width: 100%; font-size: 15px; cursor: pointer; }
        .option-price { color: var(--text-dark); font-weight: 500; }
        input[type="radio"], input[type="checkbox"] { accent-color: var(--primary); width: 20px; height: 20px; }

        /* Carrinho & Floating Button */
        .cart-item { background: var(--white); padding: 15px 20px; border-bottom: 1px solid var(--border); }
        .cart-item-header { display: flex; justify-content: space-between; font-weight: 600; margin-bottom: 5px;}
        .cart-item-desc { font-size: 12px; color: var(--text-light); margin-bottom: 10px; }
        .remove-btn { background: none; border: none; color: var(--primary); font-size: 12px; font-weight: 600; cursor: pointer; }
        .payment-section { background: var(--white); padding: 20px; margin-top: 10px; }
        .payment-option { display: flex; align-items: center; gap: 10px; padding: 15px 0; border-bottom: 1px solid var(--border); font-size: 15px;}
        .payment-option:last-child { border-bottom: none; }
        .payment-option.disabled { color: #aaa; }
        .floating-cart { position: fixed; bottom: 20px; right: 20px; background: var(--primary); color: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 4px 15px rgba(234, 29, 44, 0.4); display: none; align-items: center; gap: 10px; cursor: pointer; z-index: 900; font-weight: 700; font-size: 16px; }
        .cart-badge { background: white; color: var(--primary); border-radius: 50%; width: 24px; height: 24px; display: flex; justify-content: center; align-items: center; font-size: 14px; }

        /* Perfil / Hist√≥rico */
        .profile-info-card { background: var(--white); padding: 20px; text-align: center; margin-bottom: 10px; }
        .profile-avatar { width: 60px; height: 60px; background: var(--primary); color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: bold; margin: 0 auto 10px auto; }
        .order-history-card { background: var(--white); padding: 15px 20px; border-bottom: 1px solid var(--border); }
        .order-history-date { font-size: 12px; color: var(--text-light); margin-bottom: 5px; }
        
        /* Tela de Carregamento (Loader) */
        .loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.95); z-index: 3000; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .spinning-logo { width: 90px; height: 90px; border-radius: 50%; animation: spin 1.2s linear infinite; box-shadow: 0 0 15px rgba(234, 29, 44, 0.3); }
        .loader-text { margin-top: 20px; font-size: 18px; font-weight: 700; color: var(--text-dark); }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        @media (min-width: 768px) {
            body { max-width: 600px; margin: 0 auto; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
            .modal-content, .modal-center .modal-content { border-radius: 10px; align-self: center; }
            .modal-header { border-radius: 10px 10px 0 0; }
            .floating-cart { bottom: 30px; right: calc(50% - 280px); }
        }
    </style>
</head>
<body>

    <div class="sticky-top">
        <header>
            <div class="brand-info">
                <img src="https://i.postimg.cc/wBkj1m2y/Orange-Background.png" alt="Genu√≠no Burguer Logo" class="logo">
                <div class="store-details">
                    <h1>Genu√≠no Burguer</h1>
                    <p>BH Shopping, Belo Horizonte</p>
                    <span class="delivery-time">‚è≥ 20 a 40 minutos</span>
                </div>
            </div>
            <div class="header-actions">
                <button class="login-btn-header" id="headerLoginBtn" onclick="handleProfileClick()">
                    <span id="headerUserName">Entrar</span>
                </button>
                <div class="ifood-partner">
                    <span>Parceira</span>
                    <img src="https://i.postimg.cc/hG4fbsXF/ifood-logo-vermelho-700x699.webp" alt="iFood Logo">
                </div>
            </div>
        </header>

        <nav class="categories-nav" id="nav-categories">
            <a href="#destaques" class="category-chip active">Os mais pedidos</a>
        </nav>
    </div>

    <section class="highlights-section" id="destaques">
        <h2 class="section-title">Os mais pedidos</h2>
        <div class="horizontal-scroll" id="highlights-container"></div>
    </section>

    <main id="menu-container"></main>

    <div class="floating-cart" id="floatingCart" onclick="openCart()">
        <span class="cart-badge" id="cartBadge">0</span> Ver Sacola
    </div>

    <div class="modal-overlay" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close-modal" onclick="closeModal('productModal')">√ó</button>
                <h3 style="font-size: 16px;">Detalhes do item</h3>
            </div>
            <div class="modal-body">
                <div class="modal-product-header">
                    <img id="modalImg" src="" alt="Produto" class="modal-product-img">
                    <h2 id="modalTitle" style="font-size: 20px; margin-bottom: 8px;"></h2>
                    <p id="modalDesc" class="product-desc" style="-webkit-line-clamp: unset;"></p>
                    <h3 id="modalPrice" class="product-price" style="font-size: 18px; margin-top: 10px;"></h3>
                </div>
                <div id="optionsContainer"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" style="justify-content: space-between;" onclick="addToCart()">
                    <span>Adicionar</span><span id="btnPrice"></span>
                </button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="cartModal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close-modal" onclick="closeModal('cartModal')">√ó</button>
                <h3 style="font-size: 16px;">Sua Sacola</h3>
            </div>
            <div class="modal-body" style="background: var(--background);">
                <div id="cartItemsContainer"></div>
                <div class="payment-section">
                    <h3 style="font-size: 16px; margin-bottom: 10px;">Forma de Pagamento</h3>
                    <label class="payment-option">
                        <input type="radio" name="payment" value="pix" checked>
                        <div><strong>PIX</strong><div style="font-size: 12px; color: var(--text-light);">Aprova√ß√£o imediata</div></div>
                    </label>
                    <label class="payment-option disabled">
                        <input type="radio" name="payment" value="card" disabled>
                        <div><strong>Cart√£o de Cr√©dito / D√©bito</strong><div style="font-size: 12px; color: var(--primary);">Em manuten√ß√£o</div></div>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" style="justify-content: space-between;" onclick="requestCheckout()">
                    <span>Confirmar Endere√ßo</span><span id="cartTotalBtn"></span>
                </button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="authModal">
        <div class="modal-content" style="height: auto; max-height: 90vh;">
            <div class="modal-header">
                <button class="close-modal" onclick="closeModal('authModal')">√ó</button>
                <h3 style="font-size: 16px;">Identifica√ß√£o</h3>
            </div>
            <div class="modal-body" style="padding: 20px; background: var(--white);">
                <p style="font-size: 14px; color: var(--text-light); margin-bottom: 20px; text-align: center;">Para acompanhar seu pedido, informe seu n√∫mero.</p>
                <div class="input-group">
                    <label>Telefone (WhatsApp)</label>
                    <input type="tel" id="authPhone" class="form-control" placeholder="(31) 99999-9999">
                </div>
                <div class="input-group" id="nameFieldGroup" style="display: none;">
                    <label>Como podemos te chamar?</label>
                    <input type="text" id="authName" class="form-control" placeholder="Seu nome completo">
                </div>
                <button class="btn-primary" onclick="processAuth()">Continuar</button>
                <button class="btn-secondary" id="guestBtn" onclick="continueAsGuest()">Continuar como Visitante</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="addressModal">
        <div class="modal-content" style="height: auto; max-height: 90vh;">
            <div class="modal-header">
                <button class="close-modal" onclick="closeModal('addressModal')">√ó</button>
                <h3 style="font-size: 16px;">Onde vamos entregar?</h3>
            </div>
            <div class="modal-body" style="padding: 20px; background: var(--white);">
                <div class="input-group">
                    <label>Cidade</label>
                    <input type="text" class="form-control" value="Belo Horizonte" readonly>
                </div>
                <div class="input-group">
                    <label>Rua *</label>
                    <input type="text" id="addrRua" class="form-control" placeholder="Nome da rua">
                </div>
                <div class="input-group" style="display: flex; gap: 10px;">
                    <div style="flex: 2;">
                        <label>Bairro *</label>
                        <input type="text" id="addrBairro" class="form-control" placeholder="Seu bairro">
                    </div>
                    <div style="flex: 1;">
                        <label>N√∫mero *</label>
                        <input type="text" id="addrNum" class="form-control" placeholder="Ex: 123">
                    </div>
                </div>
                <div class="input-group">
                    <label>Complemento (Opcional)</label>
                    <input type="text" id="addrComp" class="form-control" placeholder="Apto, Bloco, Ponto de refer√™ncia...">
                </div>
                <button class="btn-primary" onclick="processAddress()">Salvar e Finalizar Pedido</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close-modal" onclick="closeModal('profileModal')">√ó</button>
                <h3 style="font-size: 16px;">Meu Perfil</h3>
            </div>
            <div class="modal-body">
                <div class="profile-info-card">
                    <div class="profile-avatar" id="profileInitials">GB</div>
                    <h2 id="profileNameDisplay" style="font-size: 18px;">Nome</h2>
                    <p id="profilePhoneDisplay" style="font-size: 14px; color: var(--text-light);"></p>
                    <button onclick="logout()" style="background:none; border:none; color:var(--primary); font-weight:600; margin-top:15px; cursor:pointer;">Sair da conta</button>
                </div>
                <h3 style="padding: 15px 20px 5px; font-size: 16px;">Meus Pedidos</h3>
                <div id="orderHistoryContainer"></div>
            </div>
        </div>
    </div>

    <div class="modal-overlay modal-center" id="customAlertModal">
        <div class="modal-content">
            <div id="customAlertIcon" style="font-size: 40px; margin-bottom: 10px;">üçî</div>
            <h3 id="customAlertTitle" style="font-size: 18px; margin-bottom: 10px;">Aviso</h3>
            <p id="customAlertMessage" style="font-size: 15px; color: var(--text-light); margin-bottom: 25px;"></p>
            <button class="btn-primary" onclick="closeCustomAlert()">Entendido</button>
        </div>
    </div>

    <div class="loader-overlay" id="loadingOverlay">
        <img src="https://i.postimg.cc/wBkj1m2y/Orange-Background.png" alt="Carregando" class="spinning-logo">
        <p class="loader-text">Processando endere√ßo...</p>
    </div>

    <script>
        // BANCO DE DADOS (Mesmo de sempre)
        const highlights = [
            { id: 101, name: "Genu√≠no Barbecue", price: 29.90, desc: "P√£o brioche, blend 160g, cheddar, cebola crispy, bacon, maionese genu√≠na e molho barbecue.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721133832475blob_600.webp", isBurger: true },
            { id: 102, name: "Genu√≠no Austr√°lia", price: 29.90, desc: "P√£o australiano, blend 160g, cheddar, cebola caramelizada, bacon, maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1726497085058blob_600.webp", isBurger: true },
            { id: 103, name: "Genu√≠no Crispy Cheese", price: 31.90, desc: "P√£o brioche, blend 160g, cheddar, mu√ßarela empanada, bacon, ketchup e maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1723224990296blob_600.webp", isBurger: true },
            { id: 104, name: "Genu√≠no Pepper", price: 29.90, desc: "Brioche tostado na manteiga, blend 100% angus 150g, queijo cheddar, cebola crispy, bacon crocante, pimenta jalape√±o, sourcream e maionese genuino.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721134687600blob_600.webp", isBurger: true },
            { id: 105, name: "Genu√≠no Cheese Burguer", price: 19.90, desc: "P√£o brioche, blend 160g, cheddar e molho genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1723224917758blob_600.webp", isBurger: true },
            { id: 106, name: "Smash Bacon", price: 29.90, desc: "P√£o brioche, 2 smashs de 50g, cheddar, bacon, cebola caramelizada e maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721134983447blob_600.webp", isBurger: true }
        ];

        const products = [
            { id: 201, category: "Os combos mais pedidos", name: "Genu√≠no Salad + Refri + Batata Crinkle P", price: 34.90, desc: "P√£o brioche, blend 160g, cheddar, alface, tomate e molho genu√≠no. + Refri + Batata Crinkle P", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1763589595711blob_600.webp", isBurger: true },
            { id: 202, category: "Os combos mais pedidos", name: "Genu√≠no Barbecue + Refri + Batata Crinkle P", price: 41.90, desc: "P√£o brioche, blend 160g, cheddar, cebola crispy, bacon, maionese genu√≠na e molho barbecue. + Refri + Batata Crinkle P", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1726152303823blob_600.webp", isBurger: true },
            { id: 203, category: "Os combos mais pedidos", name: "Genu√≠no Cheese Burguer + Refri + Batata Crinkle P", price: 32.90, desc: "P√£o brioche, blend 150g, cheddar e maionese genu√≠no. + Refri + Batata Crinkle P", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1763589627235blob_600.webp", isBurger: true },
            { id: 301, category: "Burguers", name: "Imperial Burguer - Edi√ß√£o Limitada", price: 33.90, desc: "P√£o brioche, hamburguer 150g 100% Angus, bacon crocante, cebola caramelizada, abacaxi grelhado, queijo cheddar, r√∫cula, molho barbecue e maionese genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1769777778468blob_600.webp", isBurger: true },
            { id: 302, category: "Burguers", name: "Genu√≠no Salad", price: 21.90, desc: "P√£o brioche, blend 160g, cheddar, alface, tomate e molho genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1722604953330blob_600.webp", isBurger: true },
            { id: 303, category: "Burguers", name: "Genu√≠no Barbecue", price: 29.90, desc: "P√£o brioche, blend 160g, cheddar, cebola crispy, bacon, maionese genu√≠na e molho barbecue.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721133832475blob_600.webp", isBurger: true },
            { id: 304, category: "Burguers", name: "Genu√≠no Cheese Burguer", price: 19.90, desc: "P√£o brioche, blend 160g, cheddar e molho genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1723224917758blob_600.webp", isBurger: true },
            { id: 305, category: "Burguers", name: "Genu√≠no Ribs Bbq", price: 32.90, desc: "P√£o australiano, blend 160g, cheddar, costela desfiada, bacon, cebola caramelizada, maionese genu√≠na, molho barbecue e sourcream.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1723224947603blob_600.webp", isBurger: true },
            { id: 306, category: "Burguers", name: "Genu√≠no Austr√°lia", price: 28.90, desc: "P√£o australiano, blend 160g, cheddar, cebola caramelizada, bacon, maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1726497085058blob_600.webp", isBurger: true },
            { id: 307, category: "Burguers", name: "Genu√≠no Crispy Cheese", price: 32.90, desc: "P√£o brioche, blend 160g, cheddar, mu√ßarela empanada, bacon, ketchup e maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1723224990296blob_600.webp", isBurger: true },
            { id: 308, category: "Burguers", name: "Genu√≠no Bacon Crown", price: 33.90, desc: "P√£o brioche, blend 160g, cheddar, anel de cebola enrolado com bacon crocante, molho de queijo cheddar, bacon crocante e maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/202212281834_YIG1_i.webp", isBurger: true },
            { id: 309, category: "Burguers", name: "Genu√≠no Pepper", price: 29.90, desc: "Brioche tostado na manteiga, blend 100% angus 150g, queijo cheddar, cebola crispy, bacon crocante, pimenta jalape√±o, sourcream e maionese genuino.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721134687600blob_600.webp", isBurger: true },
            { id: 310, category: "Burguers", name: "Genu√≠no Catupiry Crispy", price: 29.90, desc: "P√£o brioche, blend 160g, cheddar, Catupiry empanado, alface, tomate e maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/202212281839_183C_i.webp", isBurger: true },
            { id: 311, category: "Burguers", name: "Genu√≠no Blue Cheese", price: 32.90, desc: "P√£o brioche, blend 160g, molho gorgonzola, bacon, cebola caramelizada, r√∫cula, maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/202212281829_QG71_i.webp", isBurger: true },
            { id: 401, category: "Smash Burgers", name: "Smash Salad", price: 19.90, desc: "P√£o brioche, 2 smashs de 50g, cheddar, alface, tomate e molho genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721134963935blob_600.webp", isBurger: true },
            { id: 402, category: "Smash Burgers", name: "Smash Bacon", price: 26.90, desc: "P√£o brioche, 2 smashs de 50g, cheddar, bacon, cebola caramelizada e maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721134983447blob_600.webp", isBurger: true },
            { id: 403, category: "Smash Burgers", name: "Smash Cheese", price: 13.90, desc: "P√£o brioche, 2 smashs de 50g, cheddar e molho genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721135069727blob_600.webp", isBurger: true },
            { id: 501, category: "Chicken Burguers", name: "Chicken", price: 16.90, desc: "P√£o brioche, peito de frango empanado, bacon alface e maionese genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721135424357blob_600.webp", isBurger: true },
            { id: 502, category: "Chicken Burguers", name: "Chicken BBQ", price: 24.90, desc: "P√£o brioche, peito de frango empanado, bacon crocante cebola crispy, molho barbecue, surcream e maionese genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721135452879blob_600.webp", isBurger: true },
            { id: 503, category: "Chicken Burguers", name: "Chicken Bacon", price: 25.90, desc: "P√£o brioche, peito de frango empanado, bacon, cebola caramelizada e maionese genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1721135468538blob_600.webp", isBurger: true },
            { id: 601, category: "Por√ß√µes", name: "Tiras de Frango 400g", price: 22.90, desc: "Tiras de peito de frango crocante e empanado, acompanhado de maionese genu√≠na.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1769777984718blob_600.webp", isBurger: false },
            { id: 602, category: "Por√ß√µes", name: "Fritas 200g", price: 11.90, desc: "Batata crinkle(ondulado) temperada com hub da casa e molho genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1719509217142blob_600.webp", isBurger: false },
            { id: 603, category: "Por√ß√µes", name: "Fritas 500g", price: 24.90, desc: "Batata crinkle(ondulado) temperada com hub da casa e molho genu√≠no.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1719509217142blob_600.webp", isBurger: false },
            { id: 604, category: "Por√ß√µes", name: "Fritas Bacon 600g", price: 33.90, desc: "Batata frita crinkle (ondulado) , cheddar e bacon.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1719509985719blob_600.webp", isBurger: false },
            { id: 605, category: "Por√ß√µes", name: "Fritas Genu√≠no 600g", price: 39.90, desc: "Batata crinkle (ondulada), cheddar, costela desfiada, sourcream, molho barbecue e cebolinha.", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1719509807248blob_600.webp", isBurger: false },
            { id: 606, category: "Por√ß√µes", name: "Combo Kids", price: 26.90, desc: "P√£o brioche, smash de 50g, queijo cheddar e maionese genu√≠na + batata frita + surpresinha", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1763589230781blob_600.webp", isBurger: false },
            { id: 701, category: "Refrigerantes lata", name: "Coca-Cola Original 350ml", price: 6.00, desc: "Lata 350ml", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1725048759671blob_600.webp", isBurger: false },
            { id: 702, category: "Refrigerantes lata", name: "Coca-Cola Zero 350ml", price: 6.00, desc: "Lata 350ml", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1725048759671blob_600.webp", isBurger: false },
            { id: 703, category: "Refrigerantes lata", name: "Fanta Guaran√° 350ml", price: 6.00, desc: "Lata 350ml", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1725048759671blob_600.webp", isBurger: false },
            { id: 704, category: "Refrigerantes lata", name: "Fanta Laranja 350ml", price: 6.00, desc: "Lata 350ml", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1725048759671blob_600.webp", isBurger: false },
            { id: 705, category: "Refrigerantes lata", name: "Fanta Uva 350ml", price: 6.00, desc: "Lata 350ml", img: "https://client-assets.anota.ai/produtos/656dd5ce4f42a500191ce703/-1725048759671blob_600.webp", isBurger: false }
        ];

        const optionsTemplate = `
            <div class="option-group">
                <div class="option-group-header"><span class="option-group-title">Escolha seu Refri</span></div>
                <span class="option-group-subtitle">Escolha 1 item</span>
                <div class="option-item"><label><input type="radio" name="refri" value="0" checked> Coca-Cola Original 350ml</label></div>
                <div class="option-item"><label><input type="radio" name="refri" value="0"> Coca-Cola Zero 350ml</label></div>
            </div>
            <div class="option-group">
                <div class="option-group-header"><span class="option-group-title">Qual o ponto da carne?</span><span class="option-badge">Obrigat√≥rio</span></div>
                <span class="option-group-subtitle">Escolha 1 item</span>
                <div class="option-item"><label><input type="radio" name="ponto" value="0" checked> Ponto da Casa (rosada)</label></div>
                <div class="option-item"><label><input type="radio" name="ponto" value="0"> Bem passada</label></div>
            </div>
            <div class="option-group">
                <div class="option-group-header"><span class="option-group-title">Que tal uma maionese artesanal?</span></div>
                <span class="option-group-subtitle">Escolha at√© 1 item</span>
                <div class="option-item"><label><input type="checkbox" class="addon-checkbox" value="2.00"> Maionese</label><span class="option-price">+ R$ 2,00</span></div>
            </div>
            <div class="option-group">
                <div class="option-group-header"><span class="option-group-title">Turbine seu burguer</span></div>
                <span class="option-group-subtitle">Escolha at√© 4 itens</span>
                <div class="option-item"><label><input type="checkbox" class="addon-checkbox" value="8.00"> Carne 150g</label><span class="option-price">+ R$ 8,00</span></div>
                <div class="option-item"><label><input type="checkbox" class="addon-checkbox" value="4.00"> Bacon</label><span class="option-price">+ R$ 4,00</span></div>
                <div class="option-item"><label><input type="checkbox" class="addon-checkbox" value="2.00"> Ovo</label><span class="option-price">+ R$ 2,00</span></div>
                <div class="option-item"><label><input type="checkbox" class="addon-checkbox" value="2.00"> Picles</label><span class="option-price">+ R$ 2,00</span></div>
            </div>
        `;

        let currentProduct = null;
        let cart = [];
        let loggedUser = JSON.parse(localStorage.getItem('genuinoUser')) || null;
        let guestMode = false;
        let addressCallback = null;

        function formatMoney(value) { return `R$ ${value.toFixed(2).replace('.', ',')}`; }

        function renderMenu() {
            const hlContainer = document.getElementById('highlights-container');
            highlights.forEach(prod => {
                const card = document.createElement('div'); card.className = 'highlight-card'; card.onclick = () => openProductModal(prod);
                card.innerHTML = `<div class="highlight-info"><h3 class="product-name" style="font-size:14px;">${prod.name}</h3><span class="product-price" style="font-size:14px;">${formatMoney(prod.price)}</span></div><img src="${prod.img}" class="highlight-img" loading="lazy">`;
                hlContainer.appendChild(card);
            });

            const categories = [...new Set(products.map(p => p.category))];
            const nav = document.getElementById('nav-categories');
            const container = document.getElementById('menu-container');

            categories.forEach((cat, index) => {
                const a = document.createElement('a'); a.href = `#cat-${index}`; a.className = 'category-chip'; a.textContent = cat; nav.appendChild(a);
                const section = document.createElement('div'); section.className = 'menu-section'; section.id = `cat-${index}`;
                const h2 = document.createElement('h2'); h2.className = 'section-title'; h2.textContent = cat; section.appendChild(h2);

                const catProducts = products.filter(p => p.category === cat);
                catProducts.forEach(prod => {
                    const card = document.createElement('div'); card.className = 'product-card'; card.onclick = () => openProductModal(prod);
                    card.innerHTML = `<div class="product-info"><h3 class="product-name">${prod.name}</h3><p class="product-desc">${prod.desc}</p><span class="product-price">${formatMoney(prod.price)}</span></div><img src="${prod.img}" class="product-img" loading="lazy">`;
                    section.appendChild(card);
                });
                container.appendChild(section);
            });

            const chips = document.querySelectorAll('.category-chip');
            chips.forEach(chip => { chip.addEventListener('click', function() { chips.forEach(c => c.classList.remove('active')); this.classList.add('active'); }); });
            updateHeaderUI();
        }

        // Modais Padr√µes
        function openModal(id) { document.getElementById(id).style.display = 'flex'; document.body.style.overflow = 'hidden'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; document.body.style.overflow = 'auto'; }

        // Alerta Customizado (Substitui alert)
        function showCustomAlert(title, message, icon = 'üçî') {
            document.getElementById('customAlertTitle').textContent = title;
            document.getElementById('customAlertMessage').textContent = message;
            document.getElementById('customAlertIcon').textContent = icon;
            document.getElementById('customAlertModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        function closeCustomAlert() {
            document.getElementById('customAlertModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            if(addressCallback) { addressCallback(); addressCallback = null; }
        }

        // L√≥gica do Produto
        function openProductModal(product) {
            currentProduct = product;
            document.getElementById('modalTitle').textContent = product.name;
            document.getElementById('modalDesc').textContent = product.desc;
            document.getElementById('modalImg').src = product.img;
            updateBtnPrice();

            const optionsContainer = document.getElementById('optionsContainer');
            if(product.isBurger) {
                optionsContainer.innerHTML = optionsTemplate;
                document.querySelectorAll('.addon-checkbox, input[type="radio"]').forEach(el => { el.addEventListener('change', updateBtnPrice); });
            } else { optionsContainer.innerHTML = ''; }
            openModal('productModal');
        }

        function updateBtnPrice() {
            if(!currentProduct) return;
            let total = currentProduct.price;
            document.querySelectorAll('.addon-checkbox:checked').forEach(box => { total += parseFloat(box.value); });
            document.getElementById('btnPrice').textContent = formatMoney(total);
        }

        // Carrinho
        function addToCart() {
            if(!currentProduct) return;
            let totalOptionsPrice = 0; let selectedOptions = [];
            document.querySelectorAll('.addon-checkbox:checked').forEach(box => { totalOptionsPrice += parseFloat(box.value); selectedOptions.push(box.parentElement.textContent.trim()); });
            document.querySelectorAll('input[type="radio"]:checked').forEach(radio => { if(radio.name !== 'payment') selectedOptions.push(radio.parentElement.textContent.trim()); });

            cart.push({ product: currentProduct, price: currentProduct.price + totalOptionsPrice, options: selectedOptions });
            closeModal('productModal'); updateCartUI();

            const cartBtn = document.getElementById('floatingCart');
            cartBtn.classList.remove('pop'); void cartBtn.offsetWidth; cartBtn.classList.add('pop');
        }

        function updateCartUI() {
            const cartBtn = document.getElementById('floatingCart');
            if (cart.length > 0) { cartBtn.style.display = 'flex'; document.getElementById('cartBadge').textContent = cart.length; } 
            else { cartBtn.style.display = 'none'; closeModal('cartModal'); }
        }

        function openCart() {
            const container = document.getElementById('cartItemsContainer'); container.innerHTML = ''; let totalCartPrice = 0;
            cart.forEach((item, index) => {
                totalCartPrice += item.price;
                const optionsHtml = item.options.length > 0 ? `<div class="cart-item-desc">${item.options.join(' ‚Ä¢ ')}</div>` : '';
                container.innerHTML += `<div class="cart-item"><div class="cart-item-header"><span>1x ${item.product.name}</span><span>${formatMoney(item.price)}</span></div>${optionsHtml}<button class="remove-btn" onclick="removeFromCart(${index})">Remover item</button></div>`;
            });
            document.getElementById('cartTotalBtn').textContent = formatMoney(totalCartPrice);
            openModal('cartModal');
        }

        function removeFromCart(index) { cart.splice(index, 1); updateCartUI(); if(cart.length > 0) openCart(); }

        // Autentica√ß√£o
        function updateHeaderUI() {
            if(loggedUser) { document.getElementById('headerUserName').textContent = 'Ol√°, ' + loggedUser.name.split(' ')[0]; } 
            else { document.getElementById('headerUserName').textContent = 'Entrar'; }
        }

        function handleProfileClick() {
            if(loggedUser) { renderOrderHistory(); openModal('profileModal'); } 
            else { 
                document.getElementById('nameFieldGroup').style.display = 'none'; 
                document.getElementById('authPhone').value = ''; document.getElementById('authName').value = '';
                document.getElementById('guestBtn').style.display = 'block'; openModal('authModal');
            }
        }

        function requestCheckout() {
            if(loggedUser || guestMode) {
                closeModal('cartModal');
                openModal('addressModal');
            } else {
                document.getElementById('nameFieldGroup').style.display = 'none';
                document.getElementById('authPhone').value = ''; document.getElementById('authName').value = '';
                document.getElementById('guestBtn').style.display = 'block';
                closeModal('cartModal'); openModal('authModal');
            }
        }

        function processAuth() {
            const phone = document.getElementById('authPhone').value.trim();
            const nameInput = document.getElementById('authName');
            
            if(phone.length < 8) { showCustomAlert("Aten√ß√£o", "Por favor, digite um telefone v√°lido.", "üì±"); return; }

            let existingUser = JSON.parse(localStorage.getItem('genuinoUser_' + phone));

            if(existingUser) {
                loggedUser = existingUser; localStorage.setItem('genuinoUser', JSON.stringify(loggedUser));
                completeAuthFlow(false);
            } else {
                if(document.getElementById('nameFieldGroup').style.display === 'none') {
                    document.getElementById('nameFieldGroup').style.display = 'block';
                    showCustomAlert("Bem-vindo(a)!", "Parece que voc√™ √© novo por aqui. Por favor, informe seu nome para continuarmos.", "üëã");
                } else {
                    if(nameInput.value.trim().length < 2) { showCustomAlert("Aten√ß√£o", "Por favor, digite seu nome completo.", "üë§"); return; }
                    loggedUser = { phone: phone, name: nameInput.value.trim() };
                    localStorage.setItem('genuinoUser_' + phone, JSON.stringify(loggedUser));
                    localStorage.setItem('genuinoUser', JSON.stringify(loggedUser));
                    completeAuthFlow(true);
                }
            }
        }

        function completeAuthFlow(isNew) {
            guestMode = false; updateHeaderUI(); closeModal('authModal');
            if(cart.length > 0) { openModal('addressModal'); } 
            else if (isNew) { showCustomAlert("Conta Criada!", "Bem-vindo(a), " + loggedUser.name + "!", "üéâ"); }
        }

        function continueAsGuest() { guestMode = true; closeModal('authModal'); if(cart.length > 0) openModal('addressModal'); }
        function logout() { loggedUser = null; guestMode = false; localStorage.removeItem('genuinoUser'); updateHeaderUI(); closeModal('profileModal'); }

        // Endere√ßo e Finaliza√ß√£o
        function processAddress() {
            const rua = document.getElementById('addrRua').value.trim();
            const bairro = document.getElementById('addrBairro').value.trim();
            const num = document.getElementById('addrNum').value.trim();

            if(!rua || !bairro || !num) {
                showCustomAlert("Aten√ß√£o", "Preencha a Rua, Bairro e N√∫mero para entregar seu pedido.", "üìç");
                return;
            }

            // Anima√ß√£o de Carregamento 2 segundos
            document.getElementById('loadingOverlay').style.display = 'flex';
            
            setTimeout(() => {
                document.getElementById('loadingOverlay').style.display = 'none';
                closeModal('addressModal');
                
                // Configura callback para fechar o pedido ap√≥s cliente clicar em "Entendido"
                addressCallback = finishOrderProcess;
                showCustomAlert("Sucesso!", "Seu endere√ßo tem entrega gr√°tis! Seu pedido est√° sendo gerado.", "üõµ");
            }, 2000);
        }

        function finishOrderProcess() {
            let total = 0; cart.forEach(item => total += item.price);
            let timestampNow = Date.now();

            const newOrder = {
                id: Math.floor(Math.random() * 100000),
                timestamp: timestampNow,
                date: new Date().toLocaleDateString('pt-BR') + ' √†s ' + new Date().toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'}),
                total: total,
                items: cart.length
            };

            if(loggedUser) {
                let historyKey = 'genuinoOrders_' + loggedUser.phone;
                let userOrders = JSON.parse(localStorage.getItem(historyKey)) || [];
                userOrders.unshift(newOrder);
                localStorage.setItem(historyKey, JSON.stringify(userOrders));
            }

            cart = []; updateCartUI();
            
            // Aqui entra a integra√ß√£o do WhatsApp futuramente!
            setTimeout(() => { showCustomAlert("Pedido Recebido", "Seu pedido #" + newOrder.id + " est√° em prepara√ß√£o. Acompanhe no seu perfil!", "üçî"); }, 500);
        }

        function renderOrderHistory() {
            document.getElementById('profileNameDisplay').textContent = loggedUser.name;
            document.getElementById('profilePhoneDisplay').textContent = loggedUser.phone;
            document.getElementById('profileInitials').textContent = loggedUser.name.substring(0, 2).toUpperCase();

            const historyContainer = document.getElementById('orderHistoryContainer');
            historyContainer.innerHTML = '';

            let userOrders = JSON.parse(localStorage.getItem('genuinoOrders_' + loggedUser.phone)) || [];

            if(userOrders.length === 0) {
                historyContainer.innerHTML = '<p style="font-size: 13px; color: #777; margin-top: 10px;">Voc√™ ainda n√£o fez nenhum pedido conosco.</p>';
            } else {
                let now = Date.now();
                userOrders.forEach(order => {
                    // Calcula os minutos passados desde o pedido
                    let diffMinutes = Math.floor((now - order.timestamp) / 60000);
                    let statusHtml = '';

                    if(diffMinutes >= 55) {
                        statusHtml = '<div class="order-history-status" style="color: #ea1d2c; font-weight: 700; font-size: 14px; margin-top: 5px;">‚ùå Pedido cancelado e estorno solicitado</div>';
                    } else {
                        statusHtml = '<div class="order-history-status" style="color: #f39c12; font-weight: 700; font-size: 14px; margin-top: 5px;">‚è≥ Em prepara√ß√£o</div>';
                    }

                    historyContainer.innerHTML += `
                        <div class="order-history-card">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>Pedido #${order.id}</strong>
                                <span>${formatMoney(order.total)}</span>
                            </div>
                            <div class="order-history-date">${order.date} ‚Ä¢ ${order.items} iten(s)</div>
                            ${statusHtml}
                        </div>
                    `;
                });
            }
        }

        window.onload = renderMenu;
    </script>
</body>
</html>
